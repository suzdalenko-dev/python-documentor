
SELECT V_CODIGO_ARTICULO,V_DESCRIPCION,V_CANTIDAD_ENTREGADA,V_PRESENTACION,V_PRECIO_PRESENTACION,V_DTO_1,V_DTO_2,V_DTO_3,V_IMPORTE_LIN_NETO,V_IMP_PORTES,V_CANTIDAD_FACTURADA,V_PRECIO_NETO,V_SERIE_PEDIDO,V_NUMERO_LOTE_INT,V_DESCRIPCION_LOTE,V_EXPEDIENTE_IMPORTACION,V_DESCRIPCION_LOTE2,V_CAMBIO,V_CENTRO_COSTE,V_NUMERO_PEDIDO,V_NUMERO_LINEA_PEDIDO,V_DEVOLUCION,V_UNIDADES_ALMACEN,V_UNIDAD_ALMACEN2,V_UNID_SUB,V_UNID_SOB,V_UNID_DIS,V_UNID_EXP,D_CENTRO_COSTE,V_DTO_4,V_DTO_5,V_DTO_6,V_IDTO_1,V_IDTO_2,V_IDTO_3,V_IDTO_4,V_IDTO_5,V_IDTO_6,V_DTOS_ACUMULADOS,CODIGO_EMPRESA,NUMERO_DOC_INTERNO,NUMERO_LINEA,ORG_COMPRAS_PEDIDO,ID_CRM,HAY_ASOCIACION_CRM,HAY_REPLICACION_VTA,HAY_TEXTOS FROM (SELECT ALBARAN_COMPRAS_L.* ,pkconsgen.f_descrip_centro_doc_albcmplin(codigo_empresa, numero_doc_interno, centro_coste) D_CENTRO_COSTE,pkconsgen.hay_asociacion_crm(codigo_empresa, id_crm) HAY_ASOCIACION_CRM,pkconsgen.hay_replicacion_com_vta(albaran_compras_l.numero_doc_interno, albaran_compras_l.codigo_empresa, albaran_compras_l.numero_linea) HAY_REPLICACION_VTA,pkconsgen.hay_textos_albcompra(codigo_empresa, numero_doc_interno, numero_linea) HAY_TEXTOS,CAMBIO V_CAMBIO,CANTIDAD_ENTREGADA V_CANTIDAD_ENTREGADA,NVL(CANTIDAD_FACTURADA, 0) V_CANTIDAD_FACTURADA,CENTRO_COSTE V_CENTRO_COSTE,CODIGO_ARTICULO V_CODIGO_ARTICULO,COALESCE(albaran_compras_l.descripcion,(SELECT a.descrip_comercial FROM articulos a WHERE a.codigo_articulo=albaran_compras_l.codigo_articulo AND a.codigo_empresa=albaran_compras_l.codigo_empresa)) V_DESCRIPCION,DECODE(albaran_compras_l.numero_lote_int,NULL,NULL,(SELECT lvhl.descripcion_lote FROM historico_lotes lvhl WHERE lvhl.numero_lote_int = albaran_compras_l.numero_lote_int AND lvhl.codigo_articulo = albaran_compras_l.codigo_articulo AND lvhl.codigo_empresa = albaran_compras_l.codigo_empresa)) V_DESCRIPCION_LOTE,DECODE(albaran_compras_l.numero_lote_int,NULL,NULL,(SELECT lvhl.descripcion_lote2 FROM historico_lotes lvhl WHERE lvhl.numero_lote_int = albaran_compras_l.numero_lote_int AND lvhl.codigo_articulo = albaran_compras_l.codigo_articulo AND lvhl.codigo_empresa = albaran_compras_l.codigo_empresa)) V_DESCRIPCION_LOTE2,pkconsgen.f_get_status_devolucion(codigo_empresa, numero_doc_interno, numero_linea, status) V_DEVOLUCION,dtos_acumulados V_DTOS_ACUMULADOS,dto_1 V_DTO_1,dto_2 V_DTO_2,dto_3 V_DTO_3,dto_4 V_DTO_4,dto_5 V_DTO_5,dto_6 V_DTO_6,dto_und V_DTO_UND,dto_und_cad V_DTO_UND_CAD,EXPEDIENTE_IMPORTACION V_EXPEDIENTE_IMPORTACION,idto_1 V_IDTO_1,idto_2 V_IDTO_2,idto_3 V_IDTO_3,idto_4 V_IDTO_4,idto_5 V_IDTO_5,idto_6 V_IDTO_6,idto_und V_IDTO_UND,idto_und_cad V_IDTO_UND_CAD,PKCONSGEN.IMPORTE(importe_lin_neto, importe_lin_neto_div, divisa, importe_lin_neto_div2) V_IMPORTE_LIN_NETO,PKCONSGEN.IMPORTE(NVL(importe_portes, 0), NVL(importe_portes_div, 0), divisa) V_IMP_PORTES,NUMERO_LINEA_PEDIDO V_NUMERO_LINEA_PEDIDO,COALESCE(numero_lote_int, pkconsgen.get_numero_lote_int_albcom(codigo_empresa, codigo_articulo, numero_doc_interno, numero_linea)) V_NUMERO_LOTE_INT,NUMERO_PEDIDO V_NUMERO_PEDIDO,PKCONSGEN.IMPORTE(precio_neto * cambio, precio_neto, divisa, precio_neto * cambio * cambio_div2) V_PRECIO_NETO,PKCONSGEN.IMPORTE(precio_presentacion * cambio, precio_presentacion, divisa, precio_presentacion * cambio * cambio_div2) V_PRECIO_PRESENTACION,PRESENTACION V_PRESENTACION,SERIE_PEDIDO V_SERIE_PEDIDO,UNIDADES_ALMACEN V_UNIDADES_ALMACEN,UNIDAD_ALMACEN2 V_UNIDAD_ALMACEN2,UNID_DIS V_UNID_DIS,UNID_EXP V_UNID_EXP,UNID_SOB V_UNID_SOB,UNID_SUB V_UNID_SUB FROM ALBARAN_COMPRAS_L) ALBARAN_COMPRAS_L WHERE (CODIGO_EMPRESA='001') and (NUMERO_DOC_INTERNO='2758');

SELECT V_CODIGO_ARTICULO,V_DESCRIPCION,V_CANTIDAD_ENTREGADA,V_PRESENTACION,V_PRECIO_PRESENTACION,V_DTO_1,V_DTO_2,V_DTO_3,V_IMPORTE_LIN_NETO,V_IMP_PORTES,V_CANTIDAD_FACTURADA,V_PRECIO_NETO,V_SERIE_PEDIDO,V_NUMERO_LOTE_INT,V_DESCRIPCION_LOTE,V_EXPEDIENTE_IMPORTACION,V_DESCRIPCION_LOTE2,V_CAMBIO,V_CENTRO_COSTE,V_NUMERO_PEDIDO,V_NUMERO_LINEA_PEDIDO,V_DEVOLUCION,V_UNIDADES_ALMACEN,V_UNIDAD_ALMACEN2,V_UNID_SUB,V_UNID_SOB,V_UNID_DIS,V_UNID_EXP,D_CENTRO_COSTE,V_DTO_4,V_DTO_5,V_DTO_6,V_IDTO_1,V_IDTO_2,V_IDTO_3,V_IDTO_4,V_IDTO_5,V_IDTO_6,V_DTOS_ACUMULADOS,CODIGO_EMPRESA,NUMERO_DOC_INTERNO,NUMERO_LINEA,ORG_COMPRAS_PEDIDO,ID_CRM,HAY_ASOCIACION_CRM,HAY_REPLICACION_VTA,HAY_TEXTOS FROM (SELECT ALBARAN_COMPRAS_L.* ,pkconsgen.f_descrip_centro_doc_albcmplin(codigo_empresa, numero_doc_interno, centro_coste) D_CENTRO_COSTE,pkconsgen.hay_asociacion_crm(codigo_empresa, id_crm) HAY_ASOCIACION_CRM,pkconsgen.hay_replicacion_com_vta(albaran_compras_l.numero_doc_interno, albaran_compras_l.codigo_empresa, albaran_compras_l.numero_linea) HAY_REPLICACION_VTA,pkconsgen.hay_textos_albcompra(codigo_empresa, numero_doc_interno, numero_linea) HAY_TEXTOS,CAMBIO V_CAMBIO,CANTIDAD_ENTREGADA V_CANTIDAD_ENTREGADA,NVL(CANTIDAD_FACTURADA, 0) V_CANTIDAD_FACTURADA,CENTRO_COSTE V_CENTRO_COSTE,CODIGO_ARTICULO V_CODIGO_ARTICULO,COALESCE(albaran_compras_l.descripcion,(SELECT a.descrip_comercial FROM articulos a WHERE a.codigo_articulo=albaran_compras_l.codigo_articulo AND a.codigo_empresa=albaran_compras_l.codigo_empresa)) V_DESCRIPCION,DECODE(albaran_compras_l.numero_lote_int,NULL,NULL,(SELECT lvhl.descripcion_lote FROM historico_lotes lvhl WHERE lvhl.numero_lote_int = albaran_compras_l.numero_lote_int AND lvhl.codigo_articulo = albaran_compras_l.codigo_articulo AND lvhl.codigo_empresa = albaran_compras_l.codigo_empresa)) V_DESCRIPCION_LOTE,DECODE(albaran_compras_l.numero_lote_int,NULL,NULL,(SELECT lvhl.descripcion_lote2 FROM historico_lotes lvhl WHERE lvhl.numero_lote_int = albaran_compras_l.numero_lote_int AND lvhl.codigo_articulo = albaran_compras_l.codigo_articulo AND lvhl.codigo_empresa = albaran_compras_l.codigo_empresa)) V_DESCRIPCION_LOTE2,pkconsgen.f_get_status_devolucion(codigo_empresa, numero_doc_interno, numero_linea, status) V_DEVOLUCION,dtos_acumulados V_DTOS_ACUMULADOS,dto_1 V_DTO_1,dto_2 V_DTO_2,dto_3 V_DTO_3,dto_4 V_DTO_4,dto_5 V_DTO_5,dto_6 V_DTO_6,dto_und V_DTO_UND,dto_und_cad V_DTO_UND_CAD,EXPEDIENTE_IMPORTACION V_EXPEDIENTE_IMPORTACION,idto_1 V_IDTO_1,idto_2 V_IDTO_2,idto_3 V_IDTO_3,idto_4 V_IDTO_4,idto_5 V_IDTO_5,idto_6 V_IDTO_6,idto_und V_IDTO_UND,idto_und_cad V_IDTO_UND_CAD,PKCONSGEN.IMPORTE(importe_lin_neto, importe_lin_neto_div, divisa, importe_lin_neto_div2) V_IMPORTE_LIN_NETO,PKCONSGEN.IMPORTE(NVL(importe_portes, 0), NVL(importe_portes_div, 0), divisa) V_IMP_PORTES,NUMERO_LINEA_PEDIDO V_NUMERO_LINEA_PEDIDO,COALESCE(numero_lote_int, pkconsgen.get_numero_lote_int_albcom(codigo_empresa, codigo_articulo, numero_doc_interno, numero_linea)) V_NUMERO_LOTE_INT,NUMERO_PEDIDO V_NUMERO_PEDIDO,PKCONSGEN.IMPORTE(precio_neto * cambio, precio_neto, divisa, precio_neto * cambio * cambio_div2) V_PRECIO_NETO,PKCONSGEN.IMPORTE(precio_presentacion * cambio, precio_presentacion, divisa, precio_presentacion * cambio * cambio_div2) V_PRECIO_PRESENTACION,PRESENTACION V_PRESENTACION,SERIE_PEDIDO V_SERIE_PEDIDO,UNIDADES_ALMACEN V_UNIDADES_ALMACEN,UNIDAD_ALMACEN2 V_UNIDAD_ALMACEN2,UNID_DIS V_UNID_DIS,UNID_EXP V_UNID_EXP,UNID_SOB V_UNID_SOB,UNID_SUB V_UNID_SUB FROM ALBARAN_COMPRAS_L) ALBARAN_COMPRAS_L WHERE (CODIGO_EMPRESA='001') and (NUMERO_DOC_INTERNO='2896');

SELECT V_EXPEDIENTE_IMPORTACION,V_CAMBIO FROM (SELECT ALBARAN_COMPRAS_L.* ,pkconsgen.f_descrip_centro_doc_albcmplin(codigo_empresa, numero_doc_interno, centro_coste) D_CENTRO_COSTE,pkconsgen.hay_asociacion_crm(codigo_empresa, id_crm) HAY_ASOCIACION_CRM,pkconsgen.hay_replicacion_com_vta(albaran_compras_l.numero_doc_interno, albaran_compras_l.codigo_empresa, albaran_compras_l.numero_linea) HAY_REPLICACION_VTA,pkconsgen.hay_textos_albcompra(codigo_empresa, numero_doc_interno, numero_linea) HAY_TEXTOS,CAMBIO V_CAMBIO,CANTIDAD_ENTREGADA V_CANTIDAD_ENTREGADA,NVL(CANTIDAD_FACTURADA, 0) V_CANTIDAD_FACTURADA,CENTRO_COSTE V_CENTRO_COSTE,CODIGO_ARTICULO V_CODIGO_ARTICULO,COALESCE(albaran_compras_l.descripcion,(SELECT a.descrip_comercial FROM articulos a WHERE a.codigo_articulo=albaran_compras_l.codigo_articulo AND a.codigo_empresa=albaran_compras_l.codigo_empresa)) V_DESCRIPCION,DECODE(albaran_compras_l.numero_lote_int,NULL,NULL,(SELECT lvhl.descripcion_lote FROM historico_lotes lvhl WHERE lvhl.numero_lote_int = albaran_compras_l.numero_lote_int AND lvhl.codigo_articulo = albaran_compras_l.codigo_articulo AND lvhl.codigo_empresa = albaran_compras_l.codigo_empresa)) V_DESCRIPCION_LOTE,DECODE(albaran_compras_l.numero_lote_int,NULL,NULL,(SELECT lvhl.descripcion_lote2 FROM historico_lotes lvhl WHERE lvhl.numero_lote_int = albaran_compras_l.numero_lote_int AND lvhl.codigo_articulo = albaran_compras_l.codigo_articulo AND lvhl.codigo_empresa = albaran_compras_l.codigo_empresa)) V_DESCRIPCION_LOTE2,pkconsgen.f_get_status_devolucion(codigo_empresa, numero_doc_interno, numero_linea, status) V_DEVOLUCION,dtos_acumulados V_DTOS_ACUMULADOS,dto_1 V_DTO_1,dto_2 V_DTO_2,dto_3 V_DTO_3,dto_4 V_DTO_4,dto_5 V_DTO_5,dto_6 V_DTO_6,dto_und V_DTO_UND,dto_und_cad V_DTO_UND_CAD,EXPEDIENTE_IMPORTACION V_EXPEDIENTE_IMPORTACION,idto_1 V_IDTO_1,idto_2 V_IDTO_2,idto_3 V_IDTO_3,idto_4 V_IDTO_4,idto_5 V_IDTO_5,idto_6 V_IDTO_6,idto_und V_IDTO_UND,idto_und_cad V_IDTO_UND_CAD,PKCONSGEN.IMPORTE(importe_lin_neto, importe_lin_neto_div, divisa, importe_lin_neto_div2) V_IMPORTE_LIN_NETO,PKCONSGEN.IMPORTE(NVL(importe_portes, 0), NVL(importe_portes_div, 0), divisa) V_IMP_PORTES,NUMERO_LINEA_PEDIDO V_NUMERO_LINEA_PEDIDO,COALESCE(numero_lote_int, pkconsgen.get_numero_lote_int_albcom(codigo_empresa, codigo_articulo, numero_doc_interno, numero_linea)) V_NUMERO_LOTE_INT,NUMERO_PEDIDO V_NUMERO_PEDIDO,PKCONSGEN.IMPORTE(precio_neto * cambio, precio_neto, divisa, precio_neto * cambio * cambio_div2) V_PRECIO_NETO,PKCONSGEN.IMPORTE(precio_presentacion * cambio, precio_presentacion, divisa, precio_presentacion * cambio * cambio_div2) V_PRECIO_PRESENTACION,PRESENTACION V_PRESENTACION,SERIE_PEDIDO V_SERIE_PEDIDO,UNIDADES_ALMACEN V_UNIDADES_ALMACEN,UNIDAD_ALMACEN2 V_UNIDAD_ALMACEN2,UNID_DIS V_UNID_DIS,UNID_EXP V_UNID_EXP,UNID_SOB V_UNID_SOB,UNID_SUB V_UNID_SUB FROM ALBARAN_COMPRAS_L) ALBARAN_COMPRAS_L 
WHERE (CODIGO_EMPRESA='001') and (NUMERO_DOC_INTERNO='2896');